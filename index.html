<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TIMBER Score Tracker</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #f4f4f4;
  padding: 20px;
  text-align: center;
}
.container {
  max-width: 600px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
}
input, select, button {
  width: 100%;
  padding: 10px;
  margin: 6px 0;
  font-size: 16px;
  box-sizing: border-box;
}
button {
  background-color: #2e86de;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
}
button:hover { background-color: #1b4f72; }
table { width: 100%; border-collapse: collapse; margin-top: 20px;}
th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
th { background-color: #2e86de; color: white; }
.eliminated { color: red; font-weight: bold; }
.winner { color: green; font-weight: bold; font-size: 18px; }
</style>
</head>
<body>

<div class="container">
<h2>TIMBER Score Tracker</h2>

<label for="numPlayers">Number of Players</label>
<select id="numPlayers" onchange="createPlayerInputs()">
  <option value="2">2 Players</option>
  <option value="3" selected>3 Players</option>
  <option value="4">4 Players</option>
  <option value="5">5 Players</option>
  <option value="6">6 Players</option>
  <option value="7">7 Players</option>
  <option value="8">8 Players</option>
</select>

<div id="playerNamesDiv"></div>
<button onclick="startGame()">Start Game</button>

<div id="gameArea"></div>
</div>

<script>
let totals = [];
let round = 1;
let playerNames = [];
let numPlayers = 3;
let eliminated = [];
let scoreHistory = [];

function createPlayerInputs() {
  numPlayers = parseInt(document.getElementById('numPlayers').value);
  const div = document.getElementById('playerNamesDiv');
  div.innerHTML = '';
  for (let i = 0; i < numPlayers; i++) {
    const input = document.createElement('input');
    input.placeholder = `Player ${i+1} name`;
    input.id = `p${i}`;
    div.appendChild(input);
  }
}

createPlayerInputs();

function startGame() {
  playerNames = [];
  totals = [];
  eliminated = [];
  scoreHistory = [];
  round = 1;

  for(let i=0;i<numPlayers;i++){
    let name = document.getElementById(`p${i}`).value.trim();
    if(!name) name = `Player ${i+1}`;
    playerNames.push(name);
    totals.push(0);
    eliminated.push(false);
  }

  renderRoundInput();
  renderTable();
}

function renderRoundInput(){
  let html = `<hr><h3>Round ${round}</h3>`;
  for(let i=0;i<numPlayers;i++){
    if(eliminated[i]){
      html += `<p><strong class="eliminated">${playerNames[i]} is eliminated</strong></p>`;
    } else {
      html += `<input type="number" id="s${i}" placeholder="${playerNames[i]} score" min="0">`;
    }
  }
  html += `<button onclick="addRound()">Add Round</button>`;
  document.getElementById('gameArea').innerHTML = html;
}

function addRound(){
  const roundScores = [];
  for(let i=0;i<numPlayers;i++){
    if(eliminated[i]){
      roundScores.push('-');
      continue;
    }

    let val = parseInt(document.getElementById(`s${i}`).value) || 0;
    totals[i] += val;

    // Instant halve at 50 or 100
    if(totals[i] === 50 || totals[i] === 100){
      totals[i] = Math.floor(totals[i]/2);
      alert(`${playerNames[i]}'s total reached ${totals[i]*2} and is halved to ${totals[i]}`);
    }

    // Eliminate if >100
    if(totals[i] > 100){
      eliminated[i] = true;
      alert(`${playerNames[i]} eliminated!`);
    }

    roundScores.push(val);
  }

  scoreHistory.push(roundScores);

  // Check winner
  const remaining = playerNames.filter((_,i)=>!eliminated[i]);
  if(remaining.length === 1){
    alert(`${remaining[0]} is the winner! ðŸŽ‰`);
    document.getElementById('gameArea').innerHTML = `<h2 class="winner">${remaining[0]} WINS THE GAME! ðŸŽ‰</h2>`;
    renderTable();
    return;
  }

  round++;
  renderRoundInput();
  renderTable();
}

function renderTable(){
  let html = `<table><thead><tr><th>Round</th>`;
  for(let i=0;i<numPlayers;i++){
    html += `<th>${playerNames[i]}</th>`;
  }
  html += `</tr></thead><tbody>`;

  for(let r=0;r<scoreHistory.length;r++){
    html += `<tr><td>${r+1}</td>`;
    for(let i=0;i<numPlayers;i++){
      let val = scoreHistory[r][i];
      html += `<td>${val}</td>`;
    }
    html += `</tr>`;
  }
  html += `</tbody><tfoot><tr><th>Total</th>`;
  for(let i=0;i<numPlayers;i++){
    html += `<th>${totals[i]} ${eliminated[i]?'<span class="eliminated">(Eliminated)</span>':''}</th>`;
  }
  html += `</tr></tfoot></table>`;

  document.getElementById('gameArea').innerHTML += html;
}
</script>

</body>
</html>
